---
title: "I've got skills, they're multiplying..."
author: "Richard Martin"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(here)
library(vroom)
skills_long <- vroom(here("out","skills_long.csv"))
skills <- vroom(here("out","skills.csv"))
just_skills <- read_rds(here("out", "just_skills.rds"))
sorted_estimates <- read_rds(here("out", "sorted_estimates.rds"))
```

![53120: Dancers](grease.jpg)

## Why is skill data important?

1)  Career Planning: Job seekers can use this information to understand the skills needed for different careers and assess whether their current skill set aligns with their desired occupation.

2)  Workforce Development: Educators and training providers can use skill data to design relevant curricula and programs that address the specific skill needs of industries and occupations.

3)  Employee Training: Employers can identify the skills required for specific job roles and develop targeted training programs to enhance the skills of their workforce.

4)  Labor Market Analysis: Policymakers and researchers can use skill data to analyze the labor market and identify trends in demand and supply.

In a nutshell we should care about skills because labour is not fungible: we all differ in terms of the skills, knowledge and experience we possess. Likewise, employers are not simply looking for someone with a pulse: for every position there is a unique bundle of skills, knowledge and experience which would maximize the value of the match. The better the match, the greater the surplus that can be shared between the employer and the employee.

## ONET Skills

The Occupational Information Network (ONET) is a comprehensive database developed by the U.S. Department of Labor that provides detailed information about various occupations. One of the key components of ONET is the Skills section, which categorizes the skills required for different job roles. ONET's Skills data includes a wide range of skills that are relevant to specific occupations, helping individuals, employers, educators, and policymakers understand the skill requirements of different jobs and industries.

ONET Skills data is organized into several categories:

1)  Basic Skills: These are fundamental skills that are applicable to many different jobs. Examples include reading comprehension, active listening, writing, mathematics, and critical thinking.

2)  Cross-Functional Skills: These skills are more specific than basic skills and may be applicable across various occupations. They include skills like communication, teamwork, problem-solving, adaptability, and creativity.

3)  Technical Skills: These skills are job-specific and relate directly to the tasks and functions of a particular occupation. Technical skills can encompass a wide range of abilities, such as programming, operating machinery, using specialized software, and conducting scientific research.

4)  Job-Related Skills: These skills are directly related to the tasks and responsibilities of a specific job. For instance, a surgeon would require skills like surgical procedures, medical diagnosis, and patient care.

5)  Tools and Technology Skills: This category lists the tools, equipment, and technology that individuals in a particular occupation are expected to use. It includes skills related to operating machinery, software programs, and specialized instruments.

6)  Knowledge Areas: While not skills per se, knowledge areas are also covered in ONET data. These include subjects like mathematics and science that are essential for performing various job functions.

ONET skill data is collected through a combination of methods, including expert analysis, job analysis surveys, occupational research, and data aggregation. The process involves input from various stakeholders, including industry experts, workers, employers, and training providers. Here's an overview of how ONET skill data is collected:

1)  Job Analysis Surveys: Job analysis surveys are a primary method for collecting data on the skills required for different occupations. ONET relies on surveys administered to workers, supervisors, and subject matter experts who are familiar with the tasks, responsibilities, and skill requirements of specific jobs. These surveys gather information about the skills that are critical to performing job tasks effectively.

2)  Subject Matter Experts (SMEs): ONET collaborates with subject matter experts who have in-depth knowledge and experience in various industries and occupations. These experts provide valuable insights into the skills that are most relevant and important for specific job roles.

3)  Occupational Research: ONET researchers study various industries and occupations to identify emerging trends, technological advancements, and changes in skill requirements. This research helps ensure that ONET's skill data remains current and aligned with the evolving demands of the labor market.

4)  Existing Data Sources: ONET also aggregates information from existing sources, such as industry reports, job postings, and training programs. This data helps supplement the skill information gathered through surveys and expert input.

## Job Analysis Survey

Workers, supervisors and subject matter experts are asked about the importance and level of the 35 different skills: e.g.

onet_question.png)

## First look at the data:

So we have skills data (importance and level) for `r length(unique(skills_long$noc))` occupations.  Lets have a look at the distribution of the data.  

```{r}
skills_long%>%
  ggplot(aes(data_value, fct_reorder(element_name, data_value)))+
  geom_jitter(alpha=.05)+
  geom_boxplot(outlier.alpha = 0, fill="red", alpha=.5)+
  labs(x="", 
        y="", 
        title="Boxplots of the skills data.")+
  facet_wrap(~scale_name)
```

Looks like distributions are similar for importance and level... maybe the measures are correlated?  

```{r, fig.width=9}
skills_long%>%
  pivot_wider(names_from = scale_name, values_from = data_value)%>%
  ggplot(aes(Importance, Level))+
  geom_point(alpha=.05)+
  facet_wrap(~element_name)
```

It is kind of a pain having two measures of skill (importance and level), especially given that they are highly correlated. One option would be to choose a measure, and discard the other. Nevertheless, importance and level are not *perfectly* correlated, so choosing one would amount to discarding some information. For the remainder we will use a composite measure that we will call *skill*.

$$skill=\sqrt{level \times importance}$$ 

Two things to note: this specification is the geometric mean of level and importance, and level and importance are (imperfect) compliments in the creation of the variable $skill$.

## The composite *skill* data:

```{r, fig.width=8, fig.height=8}
heatmaply::heatmaply(just_skills, showticklabels=c(FALSE, FALSE))
```


## Weighted averages of the Skills data:

The heatmap above is somewhat overwhelming, with 35 measures of skill for `r length(unique(skills_long$noc))` occupations. We can reduce this complexity by creating a weighted average across all occupations.  We consider two weighting variables:

### Job Openings:

Perhaps the most obvious way of aggregating the skill data is using weights based on predicted job openings: doing so puts a large weight on occupations that are predicted to have many job openings, with a smaller weight on occupations with low job openings. 

### Income:

Job seekers might prefer for the skills data to be weighted based on income. This aggregation puts a larger weight on the skill profiles of occupations that have, historically, paid more.

```{r}
plt <- ggplot(skills, aes(skill_by_jo, skill_by_income, text=element_name))+
  geom_abline(slope=1, intercept=0, col="white", lwd=1.5)+
  geom_point(alpha=.5)+
  labs(x="Skill, weighted by job openings",
      y="Skill, weighted by income",
      title= "Skill, weighted by job openings vs. weighted by income")

plotly::ggplotly(plt, tooltip="text")%>%
  plotly::config(displayModeBar = FALSE)
```

Note that there are many job openings in relatively low skill occupations: e.g. Retail salespersons. In contrast, income levels are high in relatively high skill occupations: e.g. Judges. As a result, the weighted average skills (by income) exceeds the weighted average skills (by job openings), and most of the data points are above the 45 degree line.  Nevertheless, the data tells a similar story regarding the relative importance of skills, regardless of whether we weight by job openings or income.

## Relationship between skills and income

One way to think about workers is that we are just a bundle of attributes (skills, knowledge, experience) that employers want to rent. If the goal of a job seeker is to maximize their potential income, then it makes sense to invest in the skills that are most highly valued by employers. We can use hedonic estimation to estimate the elasticity of skills on income: i.e. holding all other skills constant, a 1% increase in skill is associated with a X% change in income.

```{r}
#plot all the elasticities---------------------------
sorted_estimates%>%
   mutate(term=str_replace_all(term,"`",""))%>%
   ggplot(aes(estimate, fct_reorder(term, estimate)))+
   geom_col()+
   labs(x="Skill Income Elasticities",
        y="",
        title="1% increase in skill ~ X% change in income")+
   theme_minimal()
```

Hedonic estimation paints a much different picture than weighting the data.  Consider the skill speaking. This skill is ranked as one of the top skills regardless of whether we weight by job openings or income.  Nevertheless, the occupations for which speaking is  most important tend to have lower income levels, which results in a negative association between the skill of speaking and income.

Note that these elasticities are *not* useful information if you are already happily matched in the labour market.  Once matched, the optimal skills to invest in are those in which you are relatively deficient when compared to the skill profile of the position.  Rectifying your skill deficiencies improves the match, results in more surplus being created, of which you might receive a portion. 

As a guide for what skills to invest in, these elasticities are only relevant for those who are not happily matched. (job seekers and those considering a career change). Even so, these elasticities are not causal effects: you should *not* expect your income to increase by X% if you increase your skill by 1%.  

## Added Variable Plots:

The plot of the elasticities (above) hides how much randomness there is in the data. Lets look closer at the two skills that have the strongest association (positive and negative) with income. In an added variable plot the y axis is the residual from regressing income on all other skills. The x axis is the residual from regressing the skill on all other skills. The best fit line through this cloud of residuals has the same slope as in the multiple linear regression[^1].  In the case of log-log transformed data, the slope of this line is the elasticity.  The added variable plots make it clear that there is a lot of noise in the data, and we should be suspicious of the results. 

[^1]: Frisch--Waugh--Lovell theorem.

```{r}
sorted_estimates$av_plot[[1]]
```

```{r}
sorted_estimates$av_plot[[35]]
```
